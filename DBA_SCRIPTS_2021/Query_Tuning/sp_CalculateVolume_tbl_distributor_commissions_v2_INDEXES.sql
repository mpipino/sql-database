------sp_CalculateVolume
----/****** Object:  Index [IX_DistributorCommissions_LegacyCommperioID_I]    Script Date: 4/14/2021 3:29:45 PM ******/
----DROP INDEX [IX_DistributorCommissions_LegacyCommperioID_I] ON [dbo].[tbl_distributor_commissions_v2]
----GO

----/****** Object:  Index [IX_DistributorCommissions_LegacyCommperioID_ITotalCv]    Script Date: 4/14/2021 3:30:11 PM ******/
----DROP INDEX [IX_DistributorCommissions_LegacyCommperioID_ITotalCv] ON [dbo].[tbl_distributor_commissions_v2]
----GO


----/****** Object:  Index [Ix_Nn_tbl_Distributor_Commissions_Temp_v2_CommPeriodId_Include]    Script Date: 4/14/2021 3:30:30 PM ******/
----DROP INDEX [Ix_Nn_tbl_Distributor_Commissions_Temp_v2_CommPeriodId_Include] ON [dbo].[tbl_distributor_commissions_v2]
----GO

----/****** Object:  Index [Ix_Nn_tbl_distributor_commissions_v2_CommPeriodId_DirectorBonusPaid]    Script Date: 4/14/2021 3:30:56 PM ******/
----DROP INDEX [Ix_Nn_tbl_distributor_commissions_v2_CommPeriodId_DirectorBonusPaid] ON [dbo].[tbl_distributor_commissions_v2]
----GO


----/****** Object:  Index [Ix_Nn_tbl_distributor_commissions_v2_MARKETID_CommPeriodId_GROSS_COMMISSIONS_VALUE]    Script Date: 4/14/2021 3:31:35 PM ******/
----DROP INDEX [Ix_Nn_tbl_distributor_commissions_v2_MARKETID_CommPeriodId_GROSS_COMMISSIONS_VALUE] ON [dbo].[tbl_distributor_commissions_v2]
----GO

----/****** Object:  Index [Ix_Nn_tbl_distributor_commissions_v2_MARKETID_CommPeriodId_TOTAL_COMMISSIONS_VALUE]    Script Date: 4/14/2021 3:33:06 PM ******/
----DROP INDEX [Ix_Nn_tbl_distributor_commissions_v2_MARKETID_CommPeriodId_TOTAL_COMMISSIONS_VALUE] ON [dbo].[tbl_distributor_commissions_v2]
----GO

----/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodId_I]    Script Date: 4/14/2021 3:34:55 PM ******/
----DROP INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodId_I] ON [dbo].[tbl_distributor_commissions_v2]
----GO


----/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodId_IRanks]    Script Date: 4/14/2021 3:35:24 PM ******/
----DROP INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodId_IRanks] ON [dbo].[tbl_distributor_commissions_v2]
----GO


----/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodId_ITotalCV]    Script Date: 4/14/2021 3:35:49 PM ******/
----DROP INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodId_ITotalCV] ON [dbo].[tbl_distributor_commissions_v2]
----GO


----/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodId_Itotals]    Script Date: 4/14/2021 3:36:15 PM ******/
----DROP INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodId_Itotals] ON [dbo].[tbl_distributor_commissions_v2]
----GO


----/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodIdTotalCommissions]    Script Date: 4/14/2021 3:37:10 PM ******/
----DROP INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodIdTotalCommissions] ON [dbo].[tbl_distributor_commissions_v2]
----GO

----/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_LegacyNumber]    Script Date: 4/14/2021 3:37:36 PM ******/
----DROP INDEX [IX_NN_tbldistributorcommissionsv2_LegacyNumber] ON [dbo].[tbl_distributor_commissions_v2]
----GO


----/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_LegacyNumber_IWeekGV]    Script Date: 4/14/2021 3:38:02 PM ******/
----DROP INDEX [IX_NN_tbldistributorcommissionsv2_LegacyNumber_IWeekGV] ON [dbo].[tbl_distributor_commissions_v2]
----GO

----/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_LegacyNumberCommPeriodId]    Script Date: 4/14/2021 3:38:24 PM ******/
----DROP INDEX [IX_NN_tbldistributorcommissionsv2_LegacyNumberCommPeriodId] ON [dbo].[tbl_distributor_commissions_v2]
----GO


----/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodIdPaidAsRank]    Script Date: 4/14/2021 3:36:42 PM ******/
----DROP INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodIdPaidAsRank] ON [dbo].[tbl_distributor_commissions_v2]
----GO


----/****** Object:  Index [Ix_Nn_tbldistributorcommissionsv2_New_Commperiodid_Accounttype]    Script Date: 4/14/2021 3:39:35 PM ******/
----DROP INDEX [Ix_Nn_tbldistributorcommissionsv2_New_Commperiodid_Accounttype] ON [dbo].[tbl_distributor_commissions_v2]
----GO


----/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodId]    Script Date: 4/14/2021 3:46:29 PM ******/
----DROP INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodId] ON [dbo].[tbl_distributor_commissions_v2]
----GO

----/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_LegacyNumberCommPeriodId_ICustom]    Script Date: 4/14/2021 3:46:56 PM ******/
----DROP INDEX [IX_NN_tbldistributorcommissionsv2_LegacyNumberCommPeriodId_ICustom] ON [dbo].[tbl_distributor_commissions_v2]
----GO



/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_LegacyNumberCommPeriodId_ICustom]    Script Date: 4/14/2021 3:46:56 PM ******/
CREATE NONCLUSTERED INDEX [IX_NN_tbldistributorcommissionsv2_LegacyNumberCommPeriodId_ICustom] ON [dbo].[tbl_distributor_commissions_v2]
(
	[LegacyNumber] ASC,
	[CommPeriodId] ASC
)
INCLUDE([CREATEDDATE],[Custom1],[Custom2]) WITH (STATISTICS_NORECOMPUTE = OFF, data_compression=page, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO --2 minutes


/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodId]    Script Date: 4/14/2021 3:46:29 PM ******/
CREATE NONCLUSTERED INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodId] ON [dbo].[tbl_distributor_commissions_v2]
(
	[CommPeriodId] ASC
)WITH (STATISTICS_NORECOMPUTE = OFF, data_compression=page,DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO -- 1:33



/****** Object:  Index [IX_DistributorCommissions_LegacyCommperioID_I]    Script Date: 4/14/2021 3:29:45 PM ******/
CREATE NONCLUSTERED INDEX [IX_DistributorCommissions_LegacyCommperioID_I] ON [dbo].[tbl_distributor_commissions_v2]
(
	[LegacyNumber] ASC,
	[CommPeriodId] ASC
)
INCLUDE([PaidAsRank],[ActiveTotalPV],[Dir300_1_Count],[WEEKGV],[PGV50],[custom9],[custom10],[Rnk9-gv-2weeks],[Rnk10-gv-3weeks]
,[Rnk11-gv-3weeks],[LesserBinaryVol],[LastLesserBinaryVol],[beforelastlesserbinaryvol]) 
WITH (data_compression=page, STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO


/****** Object:  Index [IX_DistributorCommissions_LegacyCommperioID_ITotalCv]    Script Date: 4/14/2021 3:30:11 PM ******/
CREATE NONCLUSTERED INDEX [IX_DistributorCommissions_LegacyCommperioID_ITotalCv] ON [dbo].[tbl_distributor_commissions_v2]
(
	[LegacyNumber] ASC,
	[CommPeriodId] ASC
)
INCLUDE([TotalCV]) WITH (data_compression=page, STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO

/****** Object:  Index [Ix_Nn_tbl_Distributor_Commissions_Temp_v2_CommPeriodId_Include]    Script Date: 4/14/2021 3:30:30 PM ******/
CREATE NONCLUSTERED INDEX [Ix_Nn_tbl_Distributor_Commissions_Temp_v2_CommPeriodId_Include] ON [dbo].[tbl_distributor_commissions_v2]
(
	[CommPeriodId] ASC
)
INCLUDE([LegacyNumber],[EndRank],[WEEKGV],[Outgoing_Left_Vol],[Outgoing_Right_Vol],[BIWEEKGV],[Weak-2-weeks],[Qual-until-date],[DirectorBonusPaid],[LesserBinaryVol],[LastLesserBinaryVol]) 
WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO




/*
/****** Object:  Index [Ix_Nn_tbl_distributor_commissions_v2_CommPeriodId_DirectorBonusPaid]    Script Date: 4/14/2021 3:30:56 PM ******/
CREATE NONCLUSTERED INDEX [Ix_Nn_tbl_distributor_commissions_v2_CommPeriodId_DirectorBonusPaid] ON [dbo].[tbl_distributor_commissions_v2]
(
	[CommPeriodId] ASC,
	[DirectorBonusPaid] ASC
)
INCLUDE([LegacyNumber]) WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO



/****** Object:  Index [Ix_Nn_tbl_distributor_commissions_v2_MARKETID_CommPeriodId_GROSS_COMMISSIONS_VALUE]    Script Date: 4/14/2021 3:31:35 PM ******/
CREATE NONCLUSTERED INDEX [Ix_Nn_tbl_distributor_commissions_v2_MARKETID_CommPeriodId_GROSS_COMMISSIONS_VALUE] ON [dbo].[tbl_distributor_commissions_v2]
(
	[MARKETID] ASC,
	[CommPeriodId] ASC,
	[GROSS_COMMISSIONS_VALUE] ASC
)
INCLUDE([LegacyNumber]) WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO



/****** Object:  Index [Ix_Nn_tbl_distributor_commissions_v2_MARKETID_CommPeriodId_TOTAL_COMMISSIONS_VALUE]    Script Date: 4/14/2021 3:33:06 PM ******/
CREATE NONCLUSTERED INDEX [Ix_Nn_tbl_distributor_commissions_v2_MARKETID_CommPeriodId_TOTAL_COMMISSIONS_VALUE] ON [dbo].[tbl_distributor_commissions_v2]
(
	[MARKETID] ASC,
	[CommPeriodId] ASC,
	[TOTAL_COMMISSIONS_VALUE] ASC
)
INCLUDE([LegacyNumber]) WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO



/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodId_I]    Script Date: 4/14/2021 3:34:55 PM ******/
CREATE NONCLUSTERED INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodId_I] ON [dbo].[tbl_distributor_commissions_v2]
(
	[CommPeriodId] ASC
)
INCLUDE([LegacyNumber],[PaidAsRank],[EndRank]) WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO



/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodId_IRanks]    Script Date: 4/14/2021 3:35:24 PM ******/
CREATE NONCLUSTERED INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodId_IRanks] ON [dbo].[tbl_distributor_commissions_v2]
(
	[CommPeriodId] ASC
)
INCLUDE([LegacyNumber],[rank9gv],[rank10gv],[rank11gv],[Rank8Gv]) WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO



/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodId_ITotalCV]    Script Date: 4/14/2021 3:35:49 PM ******/
CREATE NONCLUSTERED INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodId_ITotalCV] ON [dbo].[tbl_distributor_commissions_v2]
(
	[CommPeriodId] ASC
)
INCLUDE([TotalCV]) WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO

--15 minutes.
*/








/*


/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodId_Itotals]    Script Date: 4/14/2021 3:36:15 PM ******/
CREATE NONCLUSTERED INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodId_Itotals] ON [dbo].[tbl_distributor_commissions_v2]
(
	[CommPeriodId] ASC
)
INCLUDE([LegacyNumber],[EnrollerId],[BinarySponsorId],[TotalCV],[Custom6],[ActiveTotalPV],[TotalPV],[SponsorSequence]) 
WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO



/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodIdPaidAsRank]    Script Date: 4/14/2021 3:36:42 PM ******/
CREATE NONCLUSTERED INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodIdPaidAsRank] ON [dbo].[tbl_distributor_commissions_v2]
(
	[CommPeriodId] ASC,
	[PaidAsRank] ASC
)WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO



/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_CommPeriodIdTotalCommissions]    Script Date: 4/14/2021 3:37:10 PM ******/
CREATE NONCLUSTERED INDEX [IX_NN_tbldistributorcommissionsv2_CommPeriodIdTotalCommissions] ON [dbo].[tbl_distributor_commissions_v2]
(
	[CommPeriodId] ASC,
	[TOTAL_COMMISSIONS] ASC
)
INCLUDE([LegacyNumber]) WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO




/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_LegacyNumber]    Script Date: 4/14/2021 3:37:36 PM ******/
CREATE NONCLUSTERED INDEX [IX_NN_tbldistributorcommissionsv2_LegacyNumber] ON [dbo].[tbl_distributor_commissions_v2]
(
	[LegacyNumber] ASC
)
INCLUDE([CommPeriodId]) WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO



/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_LegacyNumber_IWeekGV]    Script Date: 4/14/2021 3:38:02 PM ******/
CREATE NONCLUSTERED INDEX [IX_NN_tbldistributorcommissionsv2_LegacyNumber_IWeekGV] ON [dbo].[tbl_distributor_commissions_v2]
(
	[LegacyNumber] ASC
)
INCLUDE([ActiveTotalPV],[CommPeriodId],[WEEKGV]) WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO


/****** Object:  Index [IX_NN_tbldistributorcommissionsv2_LegacyNumberCommPeriodId]    Script Date: 4/14/2021 3:38:24 PM ******/
CREATE NONCLUSTERED INDEX [IX_NN_tbldistributorcommissionsv2_LegacyNumberCommPeriodId] ON [dbo].[tbl_distributor_commissions_v2]
(
	[LegacyNumber] ASC,
	[CommPeriodId] ASC
)
INCLUDE([ActiveTotalPV],[Dir300_1_Count],[WEEKGV],[PGV50],[custom9],[custom10],[Weak-2-weeks],[Weak-3-weeks],[Rnk9-gv-2weeks],[Rnk10-gv-3weeks],[Rnk11-gv-3weeks]) 
WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO

/****** Object:  Index [Ix_Nn_tbldistributorcommissionsv2_New_Commperiodid_Accounttype]    Script Date: 4/14/2021 3:39:35 PM ******/
CREATE NONCLUSTERED INDEX [Ix_Nn_tbldistributorcommissionsv2_New_Commperiodid_Accounttype] ON [dbo].[tbl_distributor_commissions_v2]
(
	[CommPeriodId] ASC
)
INCLUDE([AccountType],[LegacyNumber],[EnrollerId],[LifetimeRankId],[MARKETID],[ActiveTotalPV],[IsPvActive]) 
WITH (data_compression=page,STATISTICS_NORECOMPUTE = OFF, DROP_EXISTING = OFF, ONLINE = OFF, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO

16 minutes

*/



